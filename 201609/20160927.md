# 20160927

# Index


# spring boot cheat sheet

manual[]()

tutorial[]()

add customize[]()
- page template - thymeleaf
- data reflection
- use class
- 

## what wenviroment?
- only spring boot without mvc
- use database of mysql



------------------------------
[bean of spring boot that is change xml to anotation](http://yo1000.hateblo.jp/entry/2015/05/11/162532)

------------------------------------------------
1 template

Q waht thymeleaf ?

A this is template

[thymeleaf manual](http://www.thymeleaf.org/doc/tutorials/2.1/usingthymeleaf_ja.html)

------------------------------------------------
2 data refrection

Q TO reflection with .java data to template

A 
controller
- import org.springframework.ui.Model;
- model.addAttribute("msg", "これを表示");

template(thymeleaf)

- single 

<span th:text=${msg}> </span>

- array list

<tr th:each="d : ${msg}">
    <td><span th:text="${d.no}">1</span></td>
    <td><span th:text="${d.message}">本日は晴天なり。</span></td>
</tr>

------------------------------------------------
3 make new class ? and use?

- nomal style. for java

- 


------------------------------------------------
4 sending mail

[Spring-bootからメールを送信するまで](http://qiita.com/yukihigasi/items/5f1e8c36123287974e44)

reference for application.yml
http://dev.classmethod.jp/etc/spring-boot-config-yaml/


※application.propertiesと同時に設定しても問題ない。
-application.yml------------
spring:

use sakura server stmp mail

  mail:
    host: ---.sakura.ne.jp
    port: 587
    username: --@---.jp
    password: ----
    properties.mail.smtp.auth: true
    properties.mail.smtp.starttls.enable: true
    properties.mail.smtp.protocol: Protocol.SMTP
-------------
 
 code

import org.springframework.beans.factory.annotation.Autowired;

import org.springframework.mail.MailSender;
import org.springframework.mail.SimpleMailMessage;



    @Autowired
    private MailSender sender;

    public void sendMail() {
    	System.out.println("send mail test");
        SimpleMailMessage msg = new SimpleMailMessage();

        msg.setFrom("test@mail.com");
        msg.setTo("----@gmail.com");
        msg.setSubject("テストメール"); //タイトルの設定
        msg.setText("Spring Boot より本文送信"); //本文の設定

        this.sender.send(msg);
    }
    

------------------------------------------------
4 deployment enviroment

環境に応じて、本番と開発と使い分けるために。

[Spring Bootで定義ファイル(yaml)を参照する](http://dev.classmethod.jp/etc/spring-boot-config-yaml/)


[Spring-Bootの設定プロパティと環境変数](http://qiita.com/NewGyu/items/d51f527c7199b746c6b6)


------------------------------------------------
5 database

- for mysql

--aplication.yml ---
spring:

  datasource:
    url: jdbc:mysql://localhost:3306/tester
    username: root
    password: -------
    driver-class-name: com.mysql.jdbc.Driver
  
  jpa:
    database: MYSQL
    hibernate.ddl-auto: update


不要な物もあるかも↓

--pom.xml--
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-data-jpa</artifactId>
</dependency>
		
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-jdbc</artifactId>
</dependency>

<dependency>
    <groupId>org.hsqldb</groupId>
    <artifactId>hsqldb</artifactId>
    <version>2.3.1</version>
</dependency>

<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>5.1.38</version>
</dependency>


--com.example--

-- .entity / MyUser.java

package com.example.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;

@Entity
public class MyUser {

    @Id @GeneratedValue
    private Long id;
    private String value;

    public Long getId() {
		return id;
	}

	public void setId(Long id) {
		this.id = id;
	}

	public String getValue() {
		return value;
	}

	public void setValue(String value) {
		this.value = value;
	}

	public MyUser(String value) {
        this.value = value;
    }

    public MyUser() {}

    @Override
    public String toString() {
        return "myuser [id=" + id + ", value=" + value + "]";
    }
}



-- .jpa / MyUserRepository.java

package com.example.jpa;

import com.example.entity.MyUser;
import org.springframework.data.jpa.repository.JpaRepository;

public interface MyUserRepository extends JpaRepository<MyUser, Long>{

}




データの書き込み
-- /

	import org.springframework.beans.factory.annotation.Autowired;




    @Autowired
    private MyEntityRepository repository;

    public void method() {
        this.repository.save(new MyEntity("test"));

        this.repository.findAll().forEach(System.out::println);
    }

これは例なのでリポジトリ名とかは変える事。



------------------------------------------------